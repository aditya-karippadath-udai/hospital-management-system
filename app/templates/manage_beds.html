{% extends "base_admin.html" %}

{% block title %}Manage Beds{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-12 d-flex justify-content-between align-items-center">
        <div>
            <h2 class="fw-bold">Bed Management</h2>
            <p class="text-muted">Track ward occupancy and manage hospital beds.</p>
        </div>
        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addBedModal">
            <i class="fas fa-plus me-1"></i> Add New Bed
        </button>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="card shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light">
                            <tr>
                                <th class="ps-4">Bed Number</th>
                                <th>Ward / Department</th>
                                <th>Status</th>
                                <th class="text-end pe-4">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if beds %}
                                {% for bed in beds %}
                                <tr>
                                    <td class="ps-4 fw-bold text-primary">{{ bed.bed_number }}</td>
                                    <td>{{ bed.ward }}</td>
                                    <td>
                                        {% if bed.is_occupied %}
                                            <span class="badge rounded-pill bg-danger">Occupied</span>
                                        {% else %}
                                            <span class="badge rounded-pill bg-success">Available</span>
                                        {% endif %}
                                    </td>
                                    <td class="text-end pe-4">
                                        <form action="{{ url_for('admin.toggle_bed_status', bed_id=bed.id) }}" method="POST" class="d-inline">
                                            <button type="submit" class="btn btn-sm btn-outline-info me-1" title="Toggle Occupancy">
                                                <i class="fas fa-sync-alt"></i>
                                            </button>
                                        </form>
                                        <form action="{{ url_for('admin.delete_bed', bed_id=bed.id) }}" method="POST" class="d-inline" onsubmit="return confirm('Delete this bed?')">
                                            <button type="submit" class="btn btn-sm btn-outline-danger">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </form>
                                    </td>
                                </tr>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td colspan="4" class="text-center py-5">No beds found. Add one to get started.</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Bed Modal -->
<div class="modal fade" id="addBedModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="{{ url_for('admin.manage_beds') }}" method="POST">
                <div class="modal-header">
                    <h5 class="modal-title FW-BOLD">Add Hospital Bed</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label fw-bold">Bed Number</label>
                        <input type="text" name="bed_number" class="form-control" placeholder="e.g. B-101" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Ward / Location</label>
                        <select name="ward" class="form-select" required>
                            <option value="General Ward">General Ward</option>
                            <option value="ICU">ICU</option>
                            <option value="Pediatrics">Pediatrics</option>
                            <option value="Emergency">Emergency</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save Bed</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
